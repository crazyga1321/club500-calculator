<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CLUB500 — Калькулятор роста депозита</title>

<style>
  :root{
    --bg:#0b0f1a;
    --card:#0f1724;
    --accent:#10b981; /* НЕОН-ЗЕЛЁНЫЙ */
    --muted:#94a3b8;
    --glass: rgba(255,255,255,0.03);
    --success:#10b981;
    --text:#e6eef8;
  }

  html,body{
    margin:0;
    height:100%;
    background:linear-gradient(180deg,var(--bg),#071024);
    color:var(--text);
    font-family:Inter,system-ui,Roboto,Arial;
  }
  .wrap{max-width:1100px;margin:26px auto;padding:20px}
  header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
  .logo{
    width:56px;height:56px;border-radius:12px;
    background:linear-gradient(135deg,#10b981,#06b6d4);
    display:flex;align-items:center;justify-content:center;color:#fff;
    font-size:22px;font-weight:700;
  }
  .grid{display:grid;grid-template-columns:1fr 420px;gap:18px}
  .card{
    background:var(--card);
    padding:18px;border-radius:12px;
    border:1px solid rgba(255,255,255,0.05);
  }

  .inputs label{
    display:block;margin-top:14px;color:var(--muted);font-size:13px
  }
  input, select{
    width:100%;padding:9px;margin-top:6px;border-radius:8px;
    background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:var(--text)
  }
  .row{display:flex;gap:10px;margin-top:14px}

  .btn{
    padding:10px 14px;border-radius:10px;border:0;
    background:var(--accent);color:white;font-weight:600;cursor:pointer
  }

  .fake-input{
    width:100%;padding:8px 10px;margin-top:6px;border-radius:8px;
    background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:var(--text)
  }

  table{width:100%;border-collapse:collapse;margin-top:14px}
  th,td{padding:8px 10px;text-align:center;border-bottom:1px dashed rgba(255,255,255,0.06)}
  td.small{color:var(--muted);font-size:13px}
  th{font-size:12px}

  .result{font-size:22px;color:var(--success);font-weight:700}

  .chartWrap{
    height:300px;margin-top:12px;padding:12px;border-radius:10px;
    background:linear-gradient(180deg, rgba(16,185,129,0.07), rgba(6,182,212,0.03));
    display:flex;flex-direction:column
  }

  .chartArea{flex:1;border-radius:8px;overflow:hidden}
</style>
</head>

<body>
<div class="wrap">

<header>
  <div class="logo">CL</div>
  <div>
    <h2 style="margin:0;font-size:20px">CLUB500 — Калькулятор роста депозита</h2>
    <div style="color:var(--muted);font-size:13px;margin-top:2px">
      Тёмная тема • Неон-график TradingView
    </div>
  </div>

  <!-- единственная кнопка -->
  <button class="btn" id="shareBtn" style="height:40px">Скопировать ссылку</button>
</header>

<div class="grid">

  <!-- LEFT -->
  <div class="card">

    <div class="inputs">

      <label>Начальный депозит ($)
        <input id="S0" value="100" type="number" min="0">
      </label>

      <label>Годовая доходность (%)</label>
      <input id="r" value="200" type="number" min="0">

      <label>Лет
        <select id="years">
          <option selected value="3">3</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
      </label>

      <label>Абонплата (%)
        <div class="fake-input">10%</div>
        <input id="feePct" type="hidden" value="10">
      </label>

      <label>Порог ($)
        <div class="fake-input">5000$</div>
        <input id="threshold" type="hidden" value="5000">
      </label>

      <label>Потолок абонплаты ($)
        <div class="fake-input">5000$</div>
        <input id="cap" type="hidden" value="5000">
      </label>

      <div class="row">
        <button class="btn" id="calcBtn">Посчитать</button>
        <button class="btn" style="background:#1f2937" id="resetBtn">Сброс</button>
      </div>

    </div>

    <table id="table">
      <thead>
        <tr>
          <th>Год</th><th>Начало</th><th>После роста</th><th>Fee</th><th>Итог</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

  </div>

  <!-- RIGHT -->
  <div class="card">

    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="color:var(--muted);font-size:13px">Итоговый капитал</div>
        <div id="final" class="result">$0.00</div>
      </div>

      <div>
        <div style="color:var(--muted);font-size:13px">Снятый fee</div>
        <div id="totalFees" style="font-weight:700">$0.00</div>
      </div>
    </div>

    <div class="chartWrap">
      <div style="color:var(--muted);font-size:13px;margin-bottom:4px">График (Neon TradingView)</div>
      <div class="chartArea">
        <svg id="chartSvg" width="100%" height="100%" viewBox="0 0 800 300"></svg>
      </div>
    </div>

  </div>

</div>

</div>

<script>
const $ = id => document.getElementById(id);
const safe = v => { const n=parseFloat(v); return isFinite(n)?n:0; };

function compute(p){
  let S=safe(p.S0);
  const r=safe(p.r),years=safe(p.years);
  const feePct=safe(p.feePct)/100,thr=safe(p.threshold),cap=safe(p.cap);
  const rows=[]; let totalFee=0;
  for(let y=1;y<=years;y++){
    const start=S;
    const after=start*(1+r/100);
    let fee=0;
    if(after>=thr) fee=Math.min(after*feePct,cap);
    const end=after-fee;
    rows.push({year:y,start,after,fee,end});
    totalFee+=fee; S=end;
  }
  return {rows,final:S,totalFees:totalFee};
}

function money(n){
  return '$'+Number(n).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});
}

function drawTable(rows){
  const tbody=document.querySelector('#table tbody');
  tbody.innerHTML='';
  rows.forEach(r=>{
    tbody.innerHTML+=`
      <tr>
        <td class="small">${r.year}</td>
        <td>${money(r.start)}</td>
        <td>${money(r.after)}</td>
        <td>${money(r.fee)}</td>
        <td style="font-weight:700">${money(r.end)}</td>
      </tr>`;
  });
}

function smooth(pts){
  const d=[];
  for(let i=0;i<pts.length-1;i++){
    const p0=pts[i-1]||pts[i],p1=pts[i],p2=pts[i+1],p3=pts[i+2]||p2;
    d.push([
      p1[0]+(p2[0]-p0[0])/6,
      p1[1]+(p2[1]-p0[1])/6,
      p2[0]-(p3[0]-p1[0])/6,
      p2[1]-(p3[1]-p1[1])/6,
      p2[0],p2[1]
    ]);
  }
  return d;
}

function drawChart(rows){
  const svg=$('chartSvg');
  svg.innerHTML='';
  svg.setAttribute('viewBox','0 0 800 300');

  if(!rows.length) return;

  const w=800,h=300,pad=40;
  const vals=rows.map(r=>r.end);
  const max=Math.max(...vals),min=Math.min(...vals);
  const rng=(max-min)||1;

  const pts=rows.map((r,i)=>{
    const x=pad+i/((rows.length-1)||1)*(w-pad*2);
    const y=h-pad-((r.end-min)/rng)*(h-pad*2);
    return [x,y];
  });

  let d=`M ${pts[0][0]} ${pts[0][1]}`;
  const b=smooth(pts);
  b.forEach(p=> d+=` C ${p[0]} ${p[1]}, ${p[2]} ${p[3]}, ${p[4]} ${p[5]}`);

  const fill=d+` L ${pts[pts.length-1][0]} ${h-pad} L ${pts[0][0]} ${h-pad} Z`;

  svg.innerHTML=`
    <defs>
      <linearGradient id="line" x1="0" y1="0" x2="1" y2="0">
        <stop offset="0%" stop-color="#10b981"/>
        <stop offset="100%" stop-color="#06b6d4"/>
      </linearGradient>

      <linearGradient id="fill" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#10b981" stop-opacity="0.22"/>
        <stop offset="100%" stop-color="#06b6d4" stop-opacity="0.02"/>
      </linearGradient>

      <filter id="glow" x="-200%" y="-200%" width="500%" height="500%">
        <feGaussianBlur stdDeviation="6" result="g"/>
        <feMerge><feMergeNode in="g"/><feMergeNode/></feMerge>
      </filter>
    </defs>

    <path d="${fill}" fill="url(#fill)"></path>
    <path d="${d}" fill="none" stroke="url(#line)" stroke-width="3.5"
      stroke-linecap="round" stroke-linejoin="round" filter="url(#glow)"></path>
    ${pts.map(p=>`<circle cx="${p[0]}" cy="${p[1]}" r="3" fill="#fff"></circle>`).join('')}
  `;
}

function recalc(){
  const p={
    S0:$('S0').value,r:$('r').value,years:$('years').value,
    feePct:$('feePct').value,threshold:$('threshold').value,cap:$('cap').value
  };
  const r=compute(p);
  drawTable(r.rows);
  $('final').innerText=money(r.final);
  $('totalFees').innerText=money(r.totalFees);
  drawChart(r.rows);
}

$('calcBtn').onclick=recalc;
$('resetBtn').onclick=()=>{ $('S0').value=4000; $('r').value=200; $('years').value=3; recalc(); };

$('shareBtn').onclick=()=>{
  const params=new URLSearchParams({
    S0:$('S0').value,r:$('r').value,years:$('years').value,
    feePct:$('feePct').value,threshold:$('threshold').value,cap:$('cap').value
  });
  const link=location.href.split('?')[0]+'?'+params.toString();
  navigator.clipboard.writeText(link).then(()=>alert('Ссылка скопирована!'));
};

recalc();
</script>
</body>
</html>

